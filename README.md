# Trajectory analysis
In this repo we share a method to classify trajectories based on 
- general properties, such as ergodic/non-ergodic; 
- trajectories types, such as CTRW, LW etc.
- characterisation of trajectories segments.

This work is inspired by the ANDI challenge 
https://competitions.codalab.org/competitions/23601#learn_the_details-the-andi-workshop

# Neural network architecture 
(section in process)

# Problem formulation on types of trajectories classification 

*Anomalous diffusion* is characterized by the case when MSD proportional to nonlinear growth of t to the power of a (non equal to 1),
and can be generated by a variety of stochastic processes [1]. 
Generally one can identify: 
- normal diffusion (ND), 
- directed motion (DM), motion with a drift, 
- anomalous diffusion (AD),
- confined diffusion (CD).

More specifically one can distinguish then the following types of stochastic processes:
-   the Continuous-Time Random Walk (CTRW);
-   the Fractional Brownian Motion (FBM);
-   the LÃ©vy Walk (LW);
-   the Annealed Transient Time Motion (ATTM);
-   the Scaled Brownian Motion (SBM).

# Problem formulation on ergodicity testing for trajectories  

Let us assume that our system in its present state at some time t_0, while our measurement started at some later instant of time. Then the system possesses *no age*, if 
| x(t_2 - t_0) -x(t_1-t_0)|^2 = K(t_2-t_1)
or in words, whenever we start our measurement on a process, the result of this measurement only depends on the time-lag between the measurement points denoted here as K. 


# Problem of general trajectories properties estimation 

## Ergodicity breaking tests
There are various 
*ergodicity breaking tests*, one of them was developed in [2]. 
The main idea of ergodicity breaking and mixing estimators are based on time-averaged characteristic function of increments and Khinchins theorem about relation between ergodicity and long-time vanishing velocity of autocorrelation function of stationary process (as null model of ergodic system).

## MSD vs TAMSD
In statistical mechanics, the mean squared displacement (MSD) is a measure of the deviation of the position of a particle with respect to a reference position over time. It is the most common measure of the spatial extent of random motion, and can be thought of as measuring the portion of the system "explored" by the random walker. 
Another possible alternative to MSD is time-averaged MSD or TAMSD.

## Hurst exponent 
In simple words, the Hurst exponent is used as a measure of the long-term memory of a time series. (Adapted from http://analytics-magazine.org/the-hurst-exponent-predictability-of-time-series/) Using the Hurst exponent we can classify time series into types and gain some insight into their dynamics. Here are some types of time series and the Hurst exponents associated with each of them.
\paragraph{Brownian motion or Wiener process:} In a Brownian time series there is no correlation between the observations and a future observation; a Hurst exponent close to 0.5 is indicative of a Brownian time series. 
\paragraph{Anti-persistent motion:} An anti-persistent time series (also known as a mean-reverting series) an increase will most likely be followed by a decrease or vice-versa (i.e., values will tend to revert to a mean). This means that future values have a tendency to return to a long-term mean. A Hurst exponent value between 0 and 0.5 is indicative of anti-persistent behavior and the closer the value is to 0, the stronger is the tendency for the time series to revert to its long-term means value.
\paragraph{Persistent motion:} For persistent time series an increase in values will most likely be followed by an increase in the short term and a decrease in values will most likely be followed by another decrease in the short term. A Hurst exponent value between 0.5 and 1.0 indicates persistent behavior; the larger the H value the stronger the trend.


# Problem of trajectories segmentation 
This task is additional and we do suggest some additional convex-hull alike methods for solving it. 
As in classical time-series segmentation, an input trajectory showing a change of anomalous diffusion exponent a,  and/or diffusion model must be divided into two discrete segments in order to reveal the underlying properties of each trajectory.

We divide task 3 into two subparts: 
    1. Search of turning point 
    2. Identifying regimes for trajectories between turning points 
    
A turning point is just a changes in direction. Such points are valuable features for the trajectory analysis because they can define trajectories in a space.
The Ramer-Douglas-Peucker algorithm is an algorithm for reducing the number of points in a curve that is approximated by a series of points.


[1] R. Metzler et al. "Anomalous diffusion models and their properties: non-stationarity, non-ergodicity, and ageing at the centenary of single particle tracking"  https://pubs.rsc.org/en/content/articlelanding/2014/cp/c4cp03465a#!divAbstract
 
[2]  Y. Lanoissele et al. "Revealing nonergodic dynamics in living cells from a single particle trajectory" PRE, (2016) 
